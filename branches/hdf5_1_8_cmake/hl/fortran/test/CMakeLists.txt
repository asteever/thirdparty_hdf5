cmake_minimum_required (VERSION 2.8)
PROJECT (HDF5_HL_FORTRAN_TESTS C CXX Fortran)

#-----------------------------------------------------------------------------
# Add Tests
#-----------------------------------------------------------------------------
INCLUDE_DIRECTORIES (${HDF5_SRC_DIR} ${HDF5_F90_SOURCE_DIR})
LINK_DIRECTORIES (${HDF5_SRC_DIR} ${HDF5_F90_SOURCE_DIR} ${CMAKE_LIBRARY_OUTPUT_DIRECTORY} ${CMAKE_Fortran_MODULE_DIRECTORY})

#-- Adding test for hl_f90_tstlite
ADD_EXECUTABLE (hl_f90_tstlite tstlite.f90)
IF (BUILD_SHARED_LIBS)
  IF (WIN32)
    SET_TARGET_PROPERTIES (hl_f90_tstlite PROPERTIES OUTPUT_NAME "hl_f90_tstlite")
    SET_TARGET_PROPERTIES (hl_f90_tstlite PROPERTIES PREFIX "dll")
  ENDIF (WIN32)
ENDIF (BUILD_SHARED_LIBS)
TARGET_LINK_LIBRARIES (hl_f90_tstlite ${HDF5_HL_F90_LIB_TARGET} ${HDF5_F90_LIB_TARGET})
GET_TARGET_PROPERTY (hl_f90_tstlitepath hl_f90_tstlite LOCATION)
GET_FILENAME_COMPONENT (hl_f90_tstliteexe ${hl_f90_tstlitepath} NAME)
ADD_TEST (hl_f90_tstlite ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${hl_f90_tstliteexe})

#-- Adding test for hl_f90_tstimage
ADD_EXECUTABLE (hl_f90_tstimage tstimage.f90)
IF (BUILD_SHARED_LIBS)
  IF (WIN32)
    SET_TARGET_PROPERTIES (hl_f90_tstimage PROPERTIES OUTPUT_NAME "hl_f90_tstimage")
    SET_TARGET_PROPERTIES (hl_f90_tstimage PROPERTIES PREFIX "dll")
  ENDIF (WIN32)
ENDIF (BUILD_SHARED_LIBS)
TARGET_LINK_LIBRARIES (hl_f90_tstimage  ${HDF5_HL_F90_LIB_TARGET})
GET_TARGET_PROPERTY (hl_f90_tstimagepath hl_f90_tstimage LOCATION)
GET_FILENAME_COMPONENT (hl_f90_tstimageexe ${hl_f90_tstimagepath} NAME)
ADD_TEST (hl_f90_tstimage ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${hl_f90_tstimageexe})

#-- Adding test for hl_f90_tsttable
ADD_EXECUTABLE (hl_f90_tsttable tsttable.f90)
IF (BUILD_SHARED_LIBS)
  IF (WIN32)
    SET_TARGET_PROPERTIES (hl_f90_tsttable PROPERTIES OUTPUT_NAME "hl_f90_tsttable")
    SET_TARGET_PROPERTIES (hl_f90_tsttable PROPERTIES PREFIX "dll")
  ENDIF (WIN32)
ENDIF (BUILD_SHARED_LIBS)
TARGET_LINK_LIBRARIES (hl_f90_tsttable ${HDF5_HL_F90_LIB_TARGET})
GET_TARGET_PROPERTY (hl_f90_tsttablepath hl_f90_tsttable LOCATION)
GET_FILENAME_COMPONENT (hl_f90_tsttableexe ${hl_f90_tsttablepath} NAME)
ADD_TEST (hl_f90_tsttable ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${hl_f90_tsttableexe})
