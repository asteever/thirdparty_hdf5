# HDF5 Library Makefile(.in)
#
# Copyright (C) 1997 National Center for Supercomputing Applications.
#                    All rights reserved.
#
# 
@COMMENCE@

# Add include directory to the C preprocessor flags, add -lh5tools and
# -lhdf5 to the list of libraries.
CPPFLAGS=-I../src -I. @CPPFLAGS@
LIBS=../src/libhdf5.la @LIBS@

# Test programs and scripts.
TEST_PROGS=
TEST_SCRIPTS=testh5dump.sh @TESTH5TOH4@

# These are our main targets: library and tools. We link this library
# statically because some systems can only link executables to a single
# shared library and libhdf5 is much bigger than libh5tools.
LT_LINK_LIB=$(LT) --mode=link $(CC) -static
LIB=libh5tools.a
PROGS=h5debug h5import h5ls h5repart h5dump @H5TOH4@

# Source and object files for the library.
LIB_SRC=h5tools.c h5findshd.c
LIB_OBJ=$(LIB_SRC:.c=.o)

# Source and object files for programs...
PROG_SRC=h5debug.c h5import.c h5ls.c h5repart.c h5dump.c h5dumputil.c h5toh4.c
PROG_OBJ=$(PROG_SRC:.c=.o)
PRIVATE_HDR=h5tools.h

# Source and object files for the tests
TEST_SRC=
TEST_OBJ=$(TEST_SRC:.c=.o)

# Programs have to be built before they can be tested!
check test _test: $(PROGS)

# How to build the programs... They all depend on the hdf5 library and
# the tools library compiled in this directory.
$(PROGS): $(LIB) ../src/libhdf5.la

h5debug: h5debug.o
	$(LT_LINK_EXE) $(CFLAGS) -o $@ h5debug.o $(LIB) $(LDFLAGS) $(LIBS)

h5import: h5import.o
	$(LT_LINK_EXE) $(CFLAGS) -o $@ h5import.o $(LIB) $(LDFLAGS) $(LIBS)

h5ls: h5ls.o
	$(LT_LINK_EXE) $(CFLAGS) -o $@ h5ls.o $(LIB) $(LDFLAGS) $(LIBS)

h5repart: h5repart.o
	$(LT_LINK_EXE) $(CFLAGS) -o $@ h5repart.o $(LIB) $(LDFLAGS) $(LIBS)

h5dump: h5dump.o h5dumputil.o
	$(LT_LINK_EXE) $(CFLAGS) -o $@ h5dump.o h5dumputil.o $(LIB) $(LDFLAGS) $(LIBS)

h5toh4: h5toh4.o
	$(LT_LINK_EXE) $(CFLAGS) -o $@ h5toh4.o $(LIB) $(LDFLAGS) $(LIBS)

@CONCLUDE@
