## hdf5 Parallel Library Test Makefile(.in)
##
## Copyright (C) 1998 National Center for Supercomputing Applications
##                    All rights reserved
##
##
top_srcdir=@top_srcdir@
top_builddir=..
srcdir=@srcdir@
@COMMENCE@

## Add the include directory to the C preprocessor flags the the hdf5 library
## to the library list.
CPPFLAGS=-I. -I$(srcdir) -I../src -I$(top_srcdir)/src -I$(top_srcdir)/test @CPPFLAGS@
LIBHDF5=../src/libhdf5.la
LIBH5TEST=../test/libh5test.la

## These tests are parallel
RUNTEST=$(RUNPARALLEL)

## Test programs and scripts.
##
TEST_PROGS_PARA=t_mpi
TEST_SCRIPTS=testph5.sh

## These are our main targets
PROGS=$(TEST_PROGS_PARA) testphdf5

## Temporary files
MOSTLYCLEAN=ParaEg[123].h5f
DISTCLEAN=go Makefile testph5.sh

## Test source files
TEST_PHDF5_SRC=testphdf5.c t_dset.c t_file.c t_mdset.c
TEST_PHDF5_OBJ=$(TEST_PHDF5_SRC:.c=.lo)
TEST_SRC=t_mpi.c $(TEST_PHDF5_SRC)
TEST_OBJ=$(TEST_SRC:.c=.lo)
TEST_HDR=testphdf5.h

## How to build the tests... They all depend on the hdf5 library
$(PROGS): $(LIBHDF5) $(LIBH5TEST)

$(TEST_OBJ): $(TEST_HDR)

t_mpi: t_mpi.lo
	@$(LT_LINK_EXE) $(CFLAGS) -o $@ t_mpi.lo $(LIBH5TEST) $(LIBHDF5) $(LDFLAGS) $(LIBS)

testphdf5: $(TEST_PHDF5_OBJ)
	@$(LT_LINK_EXE) $(CFLAGS) -o $@ $(TEST_PHDF5_OBJ) $(LIBH5TEST) $(LIBHDF5) $(LDFLAGS) $(LIBS)

@CONCLUDE@
