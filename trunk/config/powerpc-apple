#							-*- shell-script -*-
# This file is part of the HDF5 build script.  It is processed shortly
# after configure starts and defines, among other things, flags for
# the various compile modes.
#
# See BlankForm in this directory for details.

# The default compiler is `gcc'
if test "X-" = "X-$CC"; then
    CC=gcc
    CC_BASENAME=gcc
fi

# Figure out compiler flags
. $srcdir/config/gnu-flags

# The default Fortran 90 compiler
if test "X-" = "X-$FC"; then
    # Assume Absoft compiler
    FC=xlf
    FC_BASENAME=xlf
  else

    # Neither xlf nor f95 have a working "version" command.
    # If FC is set, try to guess which one is being used by examining
    # the last element in the path to the compiler.

    TEMP_BASENAME=`basename $FC`
    if test "xlf" = "${TEMP_BASENAME}"; then
      FC_BASENAME=xlf
    else
      FC_BASENAME=f95
    fi
fi

case $FC_BASENAME in
    xlf) 
        F9XSUFFIXFLAG="-qsuffix=f=f90 -qfree=f90"
        FCFLAGS="$FCFLAGS -static -O ${F9XSUFFIXFLAG} -qmoddir=./ "
        FSEARCH_DIRS="-I./ -I../src"
        DEBUG_FCFLAGS="-g"
        PROD_FCFLAGS="-O"
        PROFILE_FCFLAGS="-g"
        f9x_flags_set=yes
        ;;

    f95)

        F9XSUFFIXFLAG=""
# We force compiler to use upper case for external names 
# (just in case since this should be a default EIP)
        FCFLAGS="$FCFLAGS -YEXT_NAMES=UCS"
        FSEARCH_DIRS=""
        DEBUG_FCFLAGS="-g"
        PROD_FCFLAGS="-O"
        PROFILE_FCFLAGS="-g -pg"
        f9x_flags_set=yes

# f95 doesn't support shared libraries
        echo '    warning: shared libraries are not supported for f95!'
        echo '    disabling shared libraries'
        enable_shared="no"
        ;;

esac  
